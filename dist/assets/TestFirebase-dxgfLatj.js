import{r as y,j as a,z as p,_,k as T,d as u,e as f,l as I,s as A,t as P,v as $,A as C,B as E,D as R,F as k,G as U,H as V,I as B,J as Q,K as O,O as W,Q as q,P as z,R as L,S as K,V as G,W as J,Y,Z as H,T as M,$ as Z,a0 as X,a1 as ee,a2 as te,a3 as se,a4 as ae,a5 as re,a6 as oe,a7 as ne,a8 as ie,a9 as ce,p as le,i as de,aa as ue,ab as me,ac as ge,g as he,ad as be,o as xe,q as ye,h as pe}from"./index-CTVhykcm.js";const w=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:C,Bytes:E,CollectionReference:R,DocumentReference:k,DocumentSnapshot:U,FieldPath:V,FieldValue:B,Firestore:Q,FirestoreError:O,GeoPoint:W,Query:q,QueryCompositeFilterConstraint:z,QueryConstraint:L,QueryDocumentSnapshot:K,QueryFieldFilterConstraint:G,QueryOrderByConstraint:J,QuerySnapshot:Y,SnapshotMetadata:H,Timestamp:M,VectorValue:Z,_AutoId:X,_ByteString:ee,_DatabaseId:te,_DocumentKey:se,_EmptyAuthCredentialsProvider:ae,_FieldPath:re,_cast:oe,_logWarn:ne,_validateIsNotUsedTogether:ie,addDoc:T,collection:u,connectFirestoreEmulator:ce,deleteDoc:le,doc:de,ensureFirestoreConfigured:ue,executeWrite:me,getDoc:ge,getDocs:he,getFirestore:be,orderBy:xe,query:ye,updateDoc:pe},Symbol.toStringTag,{value:"Module"}));function fe(){const[m,c]=y.useState([]),[r,v]=y.useState(null),t=e=>{console.log(e),c(s=>[...s,e])},g=()=>{var e,s;t("--- Testing Authentication ---"),t(`Current user: ${((e=p.currentUser)==null?void 0:e.email)||"Not logged in"}`),t(`User ID: ${((s=p.currentUser)==null?void 0:s.uid)||"None"}`)},h=async()=>{var e;t("--- Testing Firestore ---");try{const{Timestamp:s}=await _(async()=>{const{Timestamp:d}=await Promise.resolve().then(()=>w);return{Timestamp:d}},void 0);t("Creating document...");const o=await T(u(f,"news"),{title:"Test Article",excerpt:"Test",content:"Test content",author:"Test",category:"research",image:"",date:s.now(),createdAt:s.now(),updatedAt:s.now()});t(`✅ Firestore write successful! Doc ID: ${o.id}`),t("Testing read with orderBy...");const{query:n,orderBy:i,getDocs:l}=await _(async()=>{const{query:d,orderBy:S,getDocs:j}=await Promise.resolve().then(()=>w);return{query:d,orderBy:S,getDocs:j}},void 0),D=n(u(f,"news"),i("date","desc")),F=await l(D);return t(`✅ Firestore read successful! Found ${F.size} documents`),o.id}catch(s){return t(`❌ Firestore error: ${s.message}`),t(`Error code: ${s.code}`),(e=s.message)!=null&&e.includes("index")&&t("⚠️ You may need to create an index. Check the error link above."),null}},b=async()=>{if(!r){t("❌ Please select an image first");return}t("--- Testing Storage ---"),t(`Image: ${r.name} (${r.size} bytes, ${r.type})`);try{const s=`news/test_${Date.now().toString()}.jpg`,o=I(A,s);t(`Uploading to: ${s}`);const n=await P(o,r);t("✅ Upload successful!");const i=await $(o);t(`✅ Download URL: ${i}`)}catch(e){t(`❌ Storage error: ${e.message}`),t(`Error code: ${e.code}`),t(`Full error: ${JSON.stringify(e,null,2)}`)}},x=async(e,s,o)=>{const n=new Promise((i,l)=>setTimeout(()=>l(new Error(`${o} timed out after ${s}ms`)),s));return Promise.race([e,n])},N=async()=>{c([]),g();try{t("Starting Firestore test (10s timeout)...");const e=await x(h(),1e4,"Firestore test");r&&e&&(t("Starting Storage test (15s timeout)..."),await x(b(),15e3,"Storage test"))}catch(e){t(`❌ Test failed: ${e.message}`)}};return a.jsx("div",{className:"min-h-screen bg-black text-white pt-24 pb-8 px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Firebase Diagnostics"}),a.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg mb-8",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Test Controls"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block mb-2",children:"Select Test Image:"}),a.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var s;return v(((s=e.target.files)==null?void 0:s[0])||null)},className:"w-full p-2 bg-gray-800 rounded"})]}),a.jsxs("div",{className:"flex gap-4 flex-wrap",children:[a.jsx("button",{onClick:g,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Test Auth"}),a.jsx("button",{onClick:async()=>{c([]),await h()},className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Test Firestore (No Timeout)"}),a.jsx("button",{onClick:b,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",disabled:!r,children:"Test Storage"}),a.jsx("button",{onClick:N,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Test All (With Timeout)"})]})]}),a.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Results:"}),a.jsx("div",{className:"bg-black p-4 rounded font-mono text-sm space-y-1",children:m.length===0?a.jsx("div",{className:"text-gray-500",children:"No tests run yet. Click a button above."}):m.map((e,s)=>a.jsx("div",{className:e.includes("✅")?"text-green-400":e.includes("❌")?"text-red-400":e.includes("---")?"text-yellow-400 font-bold mt-2":"text-gray-300",children:e},s))})]})]})})}export{fe as default};
